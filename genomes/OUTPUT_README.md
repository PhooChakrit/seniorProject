# ğŸ§¬ CRISPR Pipeline Output Files

This document explains the output files generated by the CRISPR-PLANT pipeline.

## ğŸ“Š Pipeline Overview

```
Input: Genome FASTA file (e.g., Oryza_sativa.IRGSP-1.0.dna.chromosome.1.fa)
                           â”‚
                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Step 1: fuzznuc             â”‚
            â”‚  Pattern: N(20)NGG (Cas9 PAM)â”‚
            â”‚  Output: .fuzznuc file       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Step 2: Convert to FASTA    â”‚
            â”‚  Extract 20bp spacer seqs    â”‚
            â”‚  Output: .fa + .ids files    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Step 3: vsearch clustering  â”‚
            â”‚  Deduplicate sequences       â”‚
            â”‚  Output: _unique.fa file     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Output Files

### 1. `GENOME_NGG_spacers.fuzznuc`

**Description:** Raw output from EMBOSS fuzznuc tool

| Property | Value                             |
| -------- | --------------------------------- |
| Format   | EMBOSS report format              |
| Content  | All PAM site matches with context |
| Size     | ~170 MB (for rice Chr1)           |

**Usage:** Intermediate file, usually not needed for downstream analysis.

---

### 2. `GENOME_NGG_spacers.fa`

**Description:** FASTA file containing ALL spacer sequences (20 bp)

**Format:**

```fasta
>Chr1:1125-1144
GTACGATAGATCCACGCGAG
>Chr1:1131-1150
TAGATCCACGCGAGAGGAAC
>Chr1:1142-1161
GAGAGGAACCGGAGAGACAA
```

**Header format:**

```
>Chr1:1125-1144
  â”‚    â”‚    â”‚
  â”‚    â”‚    â””â”€â”€ End position (1-indexed)
  â”‚    â””â”€â”€â”€â”€â”€â”€â”€ Start position (1-indexed)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Chromosome/Contig name
```

**Sequence:**

- 20 bp DNA sequence
- This is the **gRNA spacer sequence** (the part that targets the genome)
- Located immediately 5' (upstream) of the PAM (NGG)

| Property        | Value                        |
| --------------- | ---------------------------- |
| Format          | FASTA                        |
| Sequence length | 20 bp (fixed)                |
| Size            | ~96 MB (for rice Chr1)       |
| Sequences       | ~2.2 million (for rice Chr1) |

---

### 3. `GENOME_NGG_spacers_unique.fa` â­ **PRIMARY OUTPUT**

**Description:** FASTA file containing UNIQUE spacer sequences with copy number

**Format:**

```fasta
>Chr1:16790515-16790534;size=262
TGGACATATTGGAGTGTATT
>Chr1:16790514-16790533;size=259
TTGGACATATTGGAGTGTAT
>Chr1:1527163-1527182;size=166
AAGACGTAGACGCCCAACAA
```

**Header format:**

```
>Chr1:16790515-16790534;size=262
  â”‚         â”‚              â”‚
  â”‚         â”‚              â””â”€â”€ Number of times this sequence appears
  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Genomic position (start-end)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Chromosome/Contig name
```

| Property         | Value                         |
| ---------------- | ----------------------------- |
| Format           | FASTA with size annotation    |
| Sequence length  | 20 bp (fixed)                 |
| Size             | ~97 MB (for rice Chr1)        |
| Unique sequences | ~1.96 million (for rice Chr1) |

---

## ğŸ¯ Understanding `size` (Copy Number)

The `size` value indicates how many times this exact 20bp sequence appears in the genome.

| Size Value    | Meaning          | Off-target Risk                             |
| ------------- | ---------------- | ------------------------------------------- |
| `size=1`      | Unique in genome | âœ… **Lowest** - Best for specific targeting |
| `size=2-5`    | Few copies       | âš ï¸ Low - Check locations                    |
| `size=10-100` | Multiple copies  | âš ï¸ Medium - Likely repetitive regions       |
| `size=100+`   | Many copies      | âŒ **High** - Avoid for specific targeting  |

### Recommendations:

- **For gene knockout:** Use spacers with `size=1` or `size=2`
- **For repetitive elements:** Higher size values may be acceptable
- **Always verify:** Check the genomic context of your target

---

## ğŸ” Useful Commands

### Count total spacers

```bash
grep -c "^>" GENOME_NGG_spacers.fa
```

### Count unique spacers

```bash
grep -c "^>" GENOME_NGG_spacers_unique.fa
```

### Find unique spacers (size=1)

```bash
grep ";size=1$" GENOME_NGG_spacers_unique.fa | wc -l
```

### Extract spacers for a specific gene region

```bash
# Example: Get spacers between positions 1000000-1100000 on Chr1
awk '/^>Chr1:/{
  split($0, a, ":");
  split(a[2], b, "-");
  if(b[1] >= 1000000 && b[1] <= 1100000) {
    print; getline; print
  }
}' GENOME_NGG_spacers_unique.fa
```

### Find top 10 most unique spacers (lowest copy number)

```bash
grep "^>" GENOME_NGG_spacers_unique.fa | \
  sed 's/.*size=//' | sort -n | head -10
```

### Calculate GC content of a spacer

```bash
echo "GTACGATAGATCCACGCGAG" | \
  awk '{gc=gsub(/[GCgc]/,""); print gc/length($0)*100 "%"}'
```

---

## ğŸ“ˆ Statistics Example (Rice Chromosome 1)

| Metric                  | Value       |
| ----------------------- | ----------- |
| Input genome size       | ~44 MB      |
| Total PAM sites found   | 2,256,808   |
| Unique spacer sequences | 1,961,158   |
| Duplication rate        | ~13%        |
| Processing time         | ~35 seconds |

---

## ğŸ§¬ CRISPR-Cas9 Target Site Anatomy

```
5' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 3'
         â”‚                    â”‚
         â–¼                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   SPACER (20 bp)   â”‚  PAM  â”‚
    â”‚  NNNNNNNNNNNNNNNNNNâ”‚ NGG   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
              â–²
              â”‚
    This is what's in the output files
    (the 20bp spacer sequence)
```

The gRNA will bind to the complementary strand, and Cas9 will cut ~3bp upstream of the PAM.

---

## ğŸ“š References

- **EMBOSS fuzznuc:** http://emboss.sourceforge.net/apps/cvs/emboss/apps/fuzznuc.html
- **VSEARCH:** https://github.com/torognes/vsearch
- **CRISPR-PLANTv2:** Original pipeline for plant CRISPR design

---

## ğŸ’¡ Tips for gRNA Design

1. **Choose unique spacers** (`size=1`) when possible
2. **Check GC content** - aim for 40-60%
3. **Avoid poly-T stretches** - can terminate gRNA transcription
4. **Verify target location** - exons are preferred for knockouts
5. **Check for off-targets** - use tools like Cas-OFFinder
6. **Consider the PAM** - ensure NGG is present at the target site

---

_Generated by CRISPR-PLANT Pipeline_
